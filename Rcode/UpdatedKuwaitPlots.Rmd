---
title: "UpdatedKuwaitPlots"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
##All the packages essential to running my code, there might even be some that I never use, but most of them are needed and they are here:
library(plyr)
library(tidyverse)
library(forcats)
library(lubridate)
library(openair)
library(ggplot2)
library(zoo)
library(readr)
library(scales)
library(ggthemes)
library(gridExtra)
```



```{r}
##May not use all these datasets, but lets import them either way. 
setwd("~/Desktop/4Years@Reed_2/Summer Research/Kuwait202")
KuwaitFullJoin <- read_csv("Data/KuwaitFullJoin.csv")
KuwaitWeather <- read_csv("Data/KuwaitWeather.csv")
KuwaitPMFull <- read_csv("Data/KuwaitPMFull.csv")
```



```{r}

###Lets mutate it becaseu i dont know how else to make a nive loooking facetted plot.
KuwaitFullJoinFacet<- KuwaitFullJoin%>%
mutate(dayhour = make_datetime(2020,1,Day, Hour))


##Here is our first plot
#now lets make the plot

ggplot(data = KuwaitFullJoinFacet, 
       mapping = aes(x = dayhour,
                     y = RawConc,
                     fill = Year)) +  geom_line() + facet_wrap(~Month_Name)+
  labs(title = "Raw Concentration and Time", x = "Months", y = "Raw Concentration (UG/M3)" ) +
  theme_bw()
##We cannot tell which year is which so lets try something else
##Changing the fill to month_name, adding color=year
ggplot(data = KuwaitFullJoinFacet, 
       mapping = aes(x = dayhour,
                     y = RawConc,
                     fill = Month_Name, 
                     color=Year)) +  geom_line() + facet_wrap(~Month_Name)+
  labs(title = "Raw Concentration and Time", x = "Months", y = "Raw Concentration (UG/M3)" ) +
  theme_bw()
##This gave us a plot with miltiple years in each mmonth, useful. can we try that with the old dataset?
ggplot(data = KuwaitFullJoin, 
       mapping = aes(x = date,
                     y = RawConc,
                     fill = Month_Name, 
                     color=Year)) +  geom_line() + facet_wrap(~Month_Name)+
  labs(title = "Raw Concentration and Time", x = "Months", y = "Raw Concentration (UG/M3)" ) +
  theme_bw()
##The dates are all messed up, hm lets go back i guess. I am not sure how to fix that.
##i took out fill
ggplot(data = KuwaitFullJoinFacet, 
       mapping = aes(x = dayhour,
                     y = RawConc,
                      
                     color=Year)) +  geom_line() + facet_wrap(~Month_Name)+
  labs(title = "Raw Concentration and Time", x = "Months", y = "Raw Concentration (UG/M3)" ) +
  theme_bw()

##Taking out fill doesnt seem to change anything, lets just add some better colors and make the bottom better. 
ggplot(data = KuwaitFullJoinFacet, 
       mapping = aes(x = dayhour,
                     y = RawConc,
                     color=Year)) +  geom_line() + facet_wrap(~Month_Name)+
  labs(title = "Raw Concentration and Time", x = "Months", y = "Raw Concentration (UG/M3)" )+ theme_bw()
##So I cannot change the colors, but lets just look at 2020

KuwaitFullJoinFacet2020<- KuwaitFullJoin%>%

  filter(Year== 2020)
ggplot(data = KuwaitFullJoinFacet, 
       mapping = aes(x = dayhour,
                     y = RawConc)) +  geom_line() + facet_wrap(~Month_Name)+
  labs(title = "Raw Concentration and Time", x = "Months", y = "Raw Concentration (UG/M3)" )+ theme_bw()

```



```{r}
###Taking the daily means
AVGKuwaitBaseline <- timeAverage(KuwaitFullJoin, avg.time = "day")
AVGKuwaitBaseline<- AVGKuwaitBaseline%>%
 mutate(
   Month_Name = case_when(
      Month == '1' ~ "January",
      Month == '2' ~ "February",
      Month == '3' ~ "March",
      Month == '4' ~ "April",
      Month == '5' ~ "May",
      Month == '6' ~ "June",
      Month == '7' ~ "July",
      Month == '8' ~ "August",
      Month == '9' ~ "September",
      Month == '10' ~ "October",
      Month == '11' ~ "November",
      Month == '12' ~ "December" ) )%>%
  mutate(Month_Name = factor(Month_Name))%>%
  
 
    mutate(
    YearName = case_when(
      Year =='2016' ~ "2016",
      Year == '2017'~ "2017",
      Year == '2018'~ "2018",
      Year == '2019'~ "2019",
      Year == '2020'~ "2020"))
AVGKuwaitBaseline$YearName <- as.factor(AVGKuwaitBaseline$YearName)
 AVGKuwaitBaseline$Month_Name <- fct_reorder(AVGKuwaitBaseline$Month_Name, 
                                          AVGKuwaitBaseline$Month, 
                                          min)
##Now comes our boxplot
ggplot(data = AVGKuwaitBaseline, 
       mapping = aes(x = Month_Name,
                     y = RawConc,
                      fill = YearName)) +  geom_boxplot()+
  labs(title = "TRaw Concentration and Time", x = "Months", y = "Raw Concentration (UG/M3)" )+ theme_bw()


```

















